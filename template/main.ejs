<!-- <link rel="stylesheet" href="css/main.css"> -->

<% layout('layout/pattern') -%>
<div class="container">

  <div class="row">
    <div class="col-3">
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text">Широта</span>
        </div>
        <input name="latitude" class="form-control" value="48.7193900" type="text" placeholder="Широта">
      </div>
    </div>
    <div class="col-3">
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text">Долгота</span>
        </div>
        <input name="longitude" class="form-control" value="44.5018300" type="text" placeholder="Долгота">
      </div>
    </div>
    <div class="col-3">
      <div class="input-group">
        <div class="input-group-prepend">
          <span class="input-group-text">Высота</span>
        </div>
        <input name="elevation" class="form-control" type="text"  disabled>
      </div>
    </div>
    <br><br><br>

    <div class="col">
      <select id="inputState" class="form-control">
        <option selected>API</option>
        <option>Быстрое</option>
        <option>Медленное</option>
      </select>
    </div>
    <div class="col">
      <button  type="submit" class="btn btn-primary" id="submitBtn">Вычислить</button>
    </div>
  </div>

  <div class="row">
    <div class="col">
      <div id="map" style=" height: 600px"></div>
    </div>
  </div>

  <div class="row">
    <img src="images/postmanLogo.png" alt="альтернативный текст" style="width: 50px; height: 50px; margin-right:10px;">
    <h2><a href="https://documenter.getpostman.com/view/5148223/RWgtUHNf" target="_blank">API</a></h2>
  </div>

</div>



<script type="text/javascript">
// https://tech.yandex.ru/maps/doc/jsapi/2.1/dg/concepts/map-docpage/
// Функция ymaps.ready() будет вызвана, когда
// загрузятся все компоненты API, а также когда будет готово DOM-дерево.
ymaps.ready(init);

function init () {
  var myMap = new ymaps.Map("map", {
    center: [48.707103, 44.516939],
    zoom: 5
  }, {
    searchControlProvider: 'yandex#search'
  }),
  myPlacemark = new ymaps.Placemark([48.707103, 44.516939], {
    // Чтобы балун и хинт открывались на метке, необходимо задать ей определенные свойства.
    balloonContentHeader: "Балун метки",
    balloonContentBody: "Содержимое <em>балуна</em> метки",
    balloonContentFooter: "Подвал",
    hintContent: "Хинт метки"
  });

  myMap.geoObjects.add(myPlacemark);
}
// function init (latitude, longitude) {
//   var myMap = new ymaps.Map("map", {
//     center: [latitude, longitude],
//     zoom: 5
//   }, {
//     searchControlProvider: 'yandex#search'
//   }),
//   myPlacemark = new ymaps.Placemark([latitude, longitude], {
//     // Чтобы балун и хинт открывались на метке, необходимо задать ей определенные свойства.
//     balloonContentHeader: "Балун метки",
//     balloonContentBody: "Содержимое <em>балуна</em> метки",
//     balloonContentFooter: "Подвал",
//     hintContent: "Хинт метки"
//   });
//
//   myMap.geoObjects.add(myPlacemark);
// }
</script>

<script>

var submitBtn = document.getElementById("submitBtn");
submitBtn.onclick = function () {
  var data = {};
  data.latitude = $("input[name='latitude']").val();
  data.longitude = $("input[name='longitude']").val();

  // отрисуем на карте

  //ymaps.ready(init(data.latitude, data.longitude));


  $.ajax({
    type: 'POST',
    url: '/elevation',
    dataType: 'json',
    data:  data,
    success: function(data) {
      var elevation = JSON.parse(data);
      $("input[name='elevation']").val(elevation);
    }
  });
}
</script>
